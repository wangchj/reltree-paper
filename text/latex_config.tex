%%
% Define code listing style. This is used in conjunction with caption style defined below.
%%
\lstset{
    basicstyle=\small\ttfamily,
    numbers=left,
    %numberstyle=\tiny,
    %stepnumber=2,
    %numbersep=8pt,
    tabsize=2,
    %extendedchars=true,
    breaklines=true,
    keywordstyle=\color[rgb]{0.15, 0.22, 0.40},
    commentstyle=\color[rgb]{0.7,0.7,0.7},
    stringstyle=\color[rgb]{0.89,0.18,0.52},
    identifierstyle=\color[rgb]{0,0.5,0.51},
	frame=l,         
    captionpos=t,
    %keywordstyle=[1]\textbf,
    %keywordstyle=[2]\textbf,
    %keywordstyle=[3]\textbf,
    %keywordstyle=[4]\textbf,
    showspaces=false,
    showtabs=false,
    xleftmargin=17pt,
    %framexleftmargin=17pt,
    %framexrightmargin=5pt,
    %framexbottommargin=4pt,
    %backgroundcolor=\color{lightgray},
    showstringspaces=false 
}

%%
% A listing style that is currently not used.
%%
\lstdefinestyle{test_sql}{
    basicstyle=\small\ttfamily,
    %belowcaptionskip=1\baselineskip,
    breaklines=true,
    frame=l,
    language=sql,
    numbers=left,
    xleftmargin=\parindent,
    %showstringspaces=false,
    %keywordstyle=\bfseries\color{green!40!black},
    %commentstyle=\itshape\color{purple!40!black},
    %identifierstyle=\color{blue},
    %stringstyle=\color{orange},
}

%% 
% Define Style to gray background and white text.
%%
\DeclareCaptionFont{white}{\color{white}}
\DeclareCaptionFormat{listing}{\colorbox[cmyk]{0.43, 0.35, 0.35,0.01}{\parbox{\columnwidth}{#1#2#3}}}
\captionsetup[lstlisting]{format=listing,labelfont=white,textfont=white, singlelinecheck=false, margin=0pt, font={bf,footnotesize}}
